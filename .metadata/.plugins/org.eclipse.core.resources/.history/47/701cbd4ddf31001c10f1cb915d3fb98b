package es.uca.gii.csi21.turner.test;

import static org.junit.jupiter.api.Assertions.*;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;

import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;

import es.uca.gii.csi21.turner.data.Barco;
import es.uca.gii.csi21.turner.data.Data;

class BarcoTest {

	/**
	 * static void setUpBeforeClass()
	 * @throws Exception
	 * Description
	 * TODO Data class is imported and contains LoadDriver method
	 */
	@BeforeAll
	static void setUpBeforeClass() throws Exception 
	{
		Data.LoadDriver();
	}

	/**
	 * void testConstructor()
	 * @throws Exception
	 * Description
	 * TODO Database is working correctly
	 */
	@Test
	void testConstructor() throws Exception
	{
		
		Connection con = null;
		ResultSet rs = null;

		try 
		{
			Barco barco = new Barco("A45JG8W");
			con = Data.Connection();

			assertEquals("A45JG8W", barco.get_sCodRegistro());
			assertEquals("Platypus", barco.get_sNombre());
			assertEquals("300", "" + barco.get_iTripulantes() + "");
		} catch (SQLException e) 
		{
			throw e;
		} finally 
		{
			if (rs != null)
				rs.close();
			if (con != null)
				con.close();
		}
	}

	/**
	 * public void testCreate()
	 * @throws Exception
	 * Description
	 * TODO Database is working correctly
	 */
	@Test
	public void testCreate() throws Exception 
	{
		Connection con = null;
		ResultSet rs = null;

		
		try 
		{
			Barco barco = Barco.Create("B88YT9P", "Francisco", 600);
			con = Data.Connection();

			assertEquals("B88YT9P", barco.get_sCodRegistro());
			assertEquals("Francisco", barco.get_sNombre());
			assertEquals(600, barco.get_iTripulantes());
		} catch (SQLException e) 
		{
			throw e;
		} finally 
		{
			if (rs != null)
				rs.close();
			if (con != null)
				con.close();
		}
	}
}